From 769b99bbc590f7f7afb9f2b0c34ec528d787d89c Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Thu, 16 Aug 2012 07:11:02 -0500
Subject: [PATCH 2/2] beagle: add kmsmode for ulcd and default dtb_file

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 board/ti/beagle/beagle.c       |    1 +
 include/configs/omap3_beagle.h |    1 +
 2 files changed, 2 insertions(+)

diff --git a/board/ti/beagle/beagle.c b/board/ti/beagle/beagle.c
index c005345..db9a453 100644
--- a/board/ti/beagle/beagle.c
+++ b/board/ti/beagle/beagle.c
@@ -446,6 +446,7 @@ int misc_init_r(void)
 		setenv("dvimode", "800x480MR-16@60");
 		setenv("lcd1", "i2c mw 40 00 00; i2c mw 40 04 80; i2c mw 40 0d 05");
 		setenv("uenvcmd", "i2c dev 1 ; run lcd1; i2c dev 0");
+		setenv("kmsmode", "video=DVI-D-1:800x480");
 		break;
 	case BEAGLE_NO_EEPROM:
 		printf("No EEPROM on expansion board\n");
diff --git a/include/configs/omap3_beagle.h b/include/configs/omap3_beagle.h
index 0a8ecc3..8ebbace 100644
--- a/include/configs/omap3_beagle.h
+++ b/include/configs/omap3_beagle.h
@@ -221,6 +221,7 @@
 
 #define CONFIG_EXTRA_ENV_SETTINGS \
 	"loadaddr=0x80200000\0" \
+	"dtb_file=omap3-beagle\0" \
 	"rdaddr=0x81000000\0" \
 	"usbtty=cdc_acm\0" \
 	"bootfile=uImage.beagle\0" \
-- 
1.7.10.4

