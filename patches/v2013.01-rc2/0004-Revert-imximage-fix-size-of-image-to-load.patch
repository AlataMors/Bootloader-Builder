From 2d1ccbd44c11ef055eb79aaff81ca360f6741330 Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Wed, 2 Jan 2013 11:05:40 -0600
Subject: [PATCH 4/4] Revert "imximage: fix size of image to load."

This reverts commit 348ca8efb79652d2b259fbd0ed6d317a77a8cbb9.

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 tools/imximage.c |    6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/tools/imximage.c b/tools/imximage.c
index 7dbf36c..3e9ee6a 100644
--- a/tools/imximage.c
+++ b/tools/imximage.c
@@ -221,7 +221,8 @@ static void set_imx_hdr_v1(struct imx_header *imxhdr, uint32_t dcd_len,
 
 	/* The external flash header must be at the end of the DCD table */
 	dcd_v1->addr_data[dcd_len].type = sbuf->st_size +
-				imxhdr->flash_offset;
+				imxhdr->flash_offset +
+				sizeof(struct imx_header);
 
 	/* Security feature are not supported */
 	fhdr_v1->app_code_csf = 0;
@@ -252,7 +253,8 @@ static void set_imx_hdr_v2(struct imx_header *imxhdr, uint32_t dcd_len,
 
 	hdr_v2->boot_data.start = fhdr_v2->self - imxhdr->flash_offset;
 	hdr_v2->boot_data.size = sbuf->st_size +
-			imxhdr->flash_offset;
+			imxhdr->flash_offset +
+			sizeof(struct imx_header);
 
 	/* Security feature are not supported */
 	fhdr_v2->csf = 0;
-- 
1.7.10.4

